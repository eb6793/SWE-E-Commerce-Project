{"ast":null,"code":"var _jsxFileName = \"/Users/fazalmahmood/SWE-E-Commerce-Project/e-commerce-store/client/src/components/Cart/Checkout.js\";\nimport { ProductConsumer } from \"../../context-product\";\nimport React, { Component } from \"react\";\nimport Title from \"../../components/General/Title\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\n\nconst SmartyStreetsSDK = require(\"smartystreets-javascript-sdk\");\n\nconst SmartyStreetsCore = SmartyStreetsSDK.core;\nconst Lookup = SmartyStreetsSDK.usStreet.Lookup;\nlet authId = 24176270692624972; // created on smartystreets account page for localhost\n\nlet authToken = process.env.SMARTY_AUTH_TOKEN;\nconst credentials = new SmartyStreetsCore.StaticCredentials(authId, authToken);\nlet verifyAddress = SmartyStreetsCore.buildClient.usStreet(credentials);\nlet batch = new SmartyStreetsCore.Batch();\nlet lookup1 = new Lookup();\n\nfunction HandleDisplayErrors(props) {\n  let buffer = [];\n\n  if (props.display_errors) {\n    if (!props.address_verified) {\n      buffer.push( /*#__PURE__*/React.createElement(\"div\", {\n        key: \"address1\",\n        style: {\n          color: \"red\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 25,\n          columnNumber: 17\n        }\n      }, \"* Please enter a valid Shipping Address.\"));\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      padding: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 12\n    }\n  }, buffer);\n}\n\nexport default class Checkout extends Component {\n  constructor(props) {\n    super(props); // Assign state itself, and a default value for items\n\n    this.state = {\n      address_line1: \"\",\n      address_line2: \"\",\n      address_secondary: \"\",\n      address_zipcode: \"\",\n      address_city: \"\",\n      address_state: \"\",\n      email_address: \"\",\n      isAddressChanged: false,\n      id: \"\",\n      first_name: \"\",\n      last_name: \"\"\n    };\n    this.address_verified = true;\n    this.display_errors = false;\n    this.cart = [];\n  }\n\n  async componentDidMount() {\n    await this.sessionCheck();\n    await this.loadUserValues();\n    this.forceUpdate();\n  }\n\n  verifyShippingAddress() {\n    return new Promise(resolve => {\n      lookup1.street = this.state.address_line1;\n      lookup1.street2 = this.state.address_line2;\n      lookup1.secondary = this.state.address_secondary;\n      lookup1.city = this.state.address_city;\n      lookup1.state = this.state.address_state;\n      lookup1.zipCode = this.state.address_zipcode;\n      lookup1.match = \"invalid\"; // \"invalid\" is the most permissive match\n\n      batch.add(lookup1);\n      verifyAddress.send(batch).then(response => {\n        this.address_verified = true;\n        resolve(\"resolved\");\n      }).catch(() => {\n        this.address_verified = false;\n        console.log(\"address NOT verified\");\n      });\n    });\n  }\n\n  loadUserValues() {\n    return new Promise(resolve => {\n      axios.get(\"http://localhost:4000/catweallgetalong/sessions/user-info\").then(response => {\n        this.setState({\n          address_line1: response.data[0].shipping_address[0].street1,\n          address_line2: response.data[0].shipping_address[0].street2,\n          address_secondary: response.data[0].shipping_address[0].secondary,\n          address_zipcode: response.data[0].shipping_address[0].zipcode,\n          address_city: response.data[0].shipping_address[0].city,\n          address_state: response.data[0].shipping_address[0].state,\n          email_address: response.data[0].email_address,\n          first_name: response.data[0].first_name,\n          last_name: response.data[0].last_name,\n          id: response.data[0]._id\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    });\n  }\n\n  sessionCheck() {\n    return new Promise(resolve => {\n      axios.get(\"http://localhost:4000/catweallgetalong/sessions/\").then(res => {\n        //do something\n        if (res.data === true) {\n          this.directTo = \"/checkout\";\n        } else {\n          this.directTo = \"/account\";\n        }\n\n        resolve(\"resolved\");\n      }).catch(function (error) {\n        console.log(error);\n      });\n    });\n  }\n\n  async handleOnSubmit(event) {\n    event.preventDefault(); // check address is valid\n\n    if (this.state.address_line1.length > 0 && this.state.address_city.length > 0 && this.state.address_state.length > 0 && this.state.address_zipcode.length > 0 && this.state.isAddressChanged) {\n      await this.verifyShippingAddress();\n    }\n\n    if (this.address_verified && !this.state.isAddressChanged) {\n      // create order in db, and retrive the ID\n      // clear cart\n      // show order confirmed with order id\n      // add order id to account order_history\n      console.log(this.cart);\n    } else {\n      // inject red text informing what to fix\n      this.display_errors = true;\n      this.forceUpdate();\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(ProductConsumer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 13\n      }\n    }, value => {\n      const {\n        cart\n      } = value;\n      if (cart.length < 1) return /*#__PURE__*/React.createElement(Redirect, {\n        push: true,\n        to: \"/cart\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 49\n        }\n      });else {\n        this.cart = cart; // return (\n        //     <div style={{ margin: 50 }}>\n        //         <Title\n        //             name=\"Confirm\"\n        //             title=\"Shipping Address\"\n        //         />\n        //         <ProductConsumer>\n        //             {(value) => {\n        //                 const { cart } = value;\n        //                 if (cart.length < 1)\n        //                     return <Redirect push to=\"/cart\" />;\n        //                 else {\n        //                     this.cart = cart;\n        //                 }\n        //             }}\n        //         </ProductConsumer>\n        //         <HandleDisplayErrors\n        //             display_errors={this.display_errors}\n        //             address_verified={this.address_verified}\n        //         />\n        //         <form>\n        //             <div className=\"form-group\">\n        //                 <label htmlFor=\"addLine1\">\n        //                     Address Line 1\n        //                 </label>\n        //                 <input\n        //                     type=\"address\"\n        //                     className=\"form-control\"\n        //                     id=\"addLine1\"\n        //                     placeholder=\"3901 SW 154th Ave\"\n        //                     onChange={(event) =>\n        //                         this.setState({\n        //                             address_line1:\n        //                                 event.target.value,\n        //                             isAddressChanged: true,\n        //                         })\n        //                     }\n        //                     value={this.state.address_line1}\n        //                 />\n        //             </div>\n        //             <div className=\"form-group\">\n        //                 <label htmlFor=\"addLine2\">\n        //                     Address Line 2\n        //                 </label>\n        //                 <input\n        //                     type=\"address\"\n        //                     className=\"form-control\"\n        //                     id=\"addLine2\"\n        //                     placeholder=\"closest under the street\"\n        //                     onChange={(event) =>\n        //                         this.setState({\n        //                             address_line2:\n        //                                 event.target.value,\n        //                             isAddressChanged: true,\n        //                         })\n        //                     }\n        //                     value={this.state.address_line2}\n        //                 />\n        //             </div>\n        //             <div className=\"form-group\">\n        //                 <label htmlFor=\"secondary\">\n        //                     Apt / Suite / Other\n        //                 </label>\n        //                 <input\n        //                     type=\"address\"\n        //                     className=\"form-control\"\n        //                     id=\"secondary\"\n        //                     placeholder=\"Apt# 314\"\n        //                     onChange={(event) =>\n        //                         this.setState({\n        //                             address_secondary:\n        //                                 event.target.value,\n        //                             isAddressChanged: true,\n        //                         })\n        //                     }\n        //                     value={this.state.address_secondary}\n        //                 />\n        //             </div>\n        //             <div className=\"form-group\">\n        //                 <label htmlFor=\"city\">City</label>\n        //                 <input\n        //                     type=\"address\"\n        //                     className=\"form-control\"\n        //                     id=\"city\"\n        //                     placeholder=\"Davie\"\n        //                     onChange={(event) =>\n        //                         this.setState({\n        //                             address_city:\n        //                                 event.target.value,\n        //                             isAddressChanged: true,\n        //                         })\n        //                     }\n        //                     value={this.state.address_city}\n        //                 />\n        //             </div>\n        //             <div className=\"form-group\">\n        //                 <label htmlFor=\"zip\">Zipcode</label>\n        //                 <input\n        //                     type=\"address\"\n        //                     className=\"form-control\"\n        //                     id=\"zip\"\n        //                     placeholder=\"33331\"\n        //                     onChange={(event) =>\n        //                         this.setState({\n        //                             address_zipcode:\n        //                                 event.target.value,\n        //                             isAddressChanged: true,\n        //                         })\n        //                     }\n        //                     value={this.state.address_zipcode}\n        //                 />\n        //             </div>\n        //             <div className=\"form-group\">\n        //                 <label\n        //                     htmlFor=\"state\"\n        //                     className=\"col-s control-label\"\n        //                 >\n        //                     State\n        //                 </label>\n        //                 <div className=\"col-s\">\n        //                     <select\n        //                         className=\"form-control\"\n        //                         id=\"state\"\n        //                         name=\"state\"\n        //                         onChange={(event) =>\n        //                             this.setState({\n        //                                 address_state:\n        //                                     event.target.value,\n        //                                 isAddressChanged: true,\n        //                             })\n        //                         }\n        //                         value={this.state.address_state}\n        //                     >\n        //                         <option value=\"\">N/A</option>\n        //                         <option value=\"AK\">\n        //                             Alaska\n        //                         </option>\n        //                         <option value=\"AL\">\n        //                             Alabama\n        //                         </option>\n        //                         <option value=\"AR\">\n        //                             Arkansas\n        //                         </option>\n        //                         <option value=\"AZ\">\n        //                             Arizona\n        //                         </option>\n        //                         <option value=\"CA\">\n        //                             California\n        //                         </option>\n        //                         <option value=\"CO\">\n        //                             Colorado\n        //                         </option>\n        //                         <option value=\"CT\">\n        //                             Connecticut\n        //                         </option>\n        //                         <option value=\"DC\">\n        //                             District of Columbia\n        //                         </option>\n        //                         <option value=\"DE\">\n        //                             Delaware\n        //                         </option>\n        //                         <option value=\"FL\">\n        //                             Florida\n        //                         </option>\n        //                         <option value=\"GA\">\n        //                             Georgia\n        //                         </option>\n        //                         <option value=\"HI\">\n        //                             Hawaii\n        //                         </option>\n        //                         <option value=\"IA\">Iowa</option>\n        //                         <option value=\"ID\">\n        //                             Idaho\n        //                         </option>\n        //                         <option value=\"IL\">\n        //                             Illinois\n        //                         </option>\n        //                         <option value=\"IN\">\n        //                             Indiana\n        //                         </option>\n        //                         <option value=\"KS\">\n        //                             Kansas\n        //                         </option>\n        //                         <option value=\"KY\">\n        //                             Kentucky\n        //                         </option>\n        //                         <option value=\"LA\">\n        //                             Louisiana\n        //                         </option>\n        //                         <option value=\"MA\">\n        //                             Massachusetts\n        //                         </option>\n        //                         <option value=\"MD\">\n        //                             Maryland\n        //                         </option>\n        //                         <option value=\"ME\">\n        //                             Maine\n        //                         </option>\n        //                         <option value=\"MI\">\n        //                             Michigan\n        //                         </option>\n        //                         <option value=\"MN\">\n        //                             Minnesota\n        //                         </option>\n        //                         <option value=\"MO\">\n        //                             Missouri\n        //                         </option>\n        //                         <option value=\"MS\">\n        //                             Mississippi\n        //                         </option>\n        //                         <option value=\"MT\">\n        //                             Montana\n        //                         </option>\n        //                         <option value=\"NC\">\n        //                             North Carolina\n        //                         </option>\n        //                         <option value=\"ND\">\n        //                             North Dakota\n        //                         </option>\n        //                         <option value=\"NE\">\n        //                             Nebraska\n        //                         </option>\n        //                         <option value=\"NH\">\n        //                             New Hampshire\n        //                         </option>\n        //                         <option value=\"NJ\">\n        //                             New Jersey\n        //                         </option>\n        //                         <option value=\"NM\">\n        //                             New Mexico\n        //                         </option>\n        //                         <option value=\"NV\">\n        //                             Nevada\n        //                         </option>\n        //                         <option value=\"NY\">\n        //                             New York\n        //                         </option>\n        //                         <option value=\"OH\">Ohio</option>\n        //                         <option value=\"OK\">\n        //                             Oklahoma\n        //                         </option>\n        //                         <option value=\"OR\">\n        //                             Oregon\n        //                         </option>\n        //                         <option value=\"PA\">\n        //                             Pennsylvania\n        //                         </option>\n        //                         <option value=\"PR\">\n        //                             Puerto Rico\n        //                         </option>\n        //                         <option value=\"RI\">\n        //                             Rhode Island\n        //                         </option>\n        //                         <option value=\"SC\">\n        //                             South Carolina\n        //                         </option>\n        //                         <option value=\"SD\">\n        //                             South Dakota\n        //                         </option>\n        //                         <option value=\"TN\">\n        //                             Tennessee\n        //                         </option>\n        //                         <option value=\"TX\">\n        //                             Texas\n        //                         </option>\n        //                         <option value=\"UT\">Utah</option>\n        //                         <option value=\"VA\">\n        //                             Virginia\n        //                         </option>\n        //                         <option value=\"VT\">\n        //                             Vermont\n        //                         </option>\n        //                         <option value=\"WA\">\n        //                             Washington\n        //                         </option>\n        //                         <option value=\"WI\">\n        //                             Wisconsin\n        //                         </option>\n        //                         <option value=\"WV\">\n        //                             West Virginia\n        //                         </option>\n        //                         <option value=\"WY\">\n        //                             Wyoming\n        //                         </option>\n        //                     </select>\n        //                 </div>\n        //             </div>\n        //             <button\n        //                 className=\"btn btn-success text-uppercase mb-3 px-5\"\n        //                 onClick={this.handleOnSubmit.bind(this)}\n        //             >\n        //                 Submit Order\n        //             </button>\n        //         </form>\n        //     </div>\n        // );\n      }\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/fazalmahmood/SWE-E-Commerce-Project/e-commerce-store/client/src/components/Cart/Checkout.js"],"names":["ProductConsumer","React","Component","Title","Redirect","axios","SmartyStreetsSDK","require","SmartyStreetsCore","core","Lookup","usStreet","authId","authToken","process","env","SMARTY_AUTH_TOKEN","credentials","StaticCredentials","verifyAddress","buildClient","batch","Batch","lookup1","HandleDisplayErrors","props","buffer","display_errors","address_verified","push","color","padding","Checkout","constructor","state","address_line1","address_line2","address_secondary","address_zipcode","address_city","address_state","email_address","isAddressChanged","id","first_name","last_name","cart","componentDidMount","sessionCheck","loadUserValues","forceUpdate","verifyShippingAddress","Promise","resolve","street","street2","secondary","city","zipCode","match","add","send","then","response","catch","console","log","get","setState","data","shipping_address","street1","zipcode","_id","error","res","directTo","handleOnSubmit","event","preventDefault","length","render","value"],"mappings":"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B,KACK;AACD,aAAKlC,IAAL,GAAYA,IAAZ,CADC,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH;AACJ,KAhTL,CADJ;AAoTH;;AAxb2C","sourcesContent":["import { ProductConsumer } from \"../../context-product\";\nimport React, { Component } from \"react\";\nimport Title from \"../../components/General/Title\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\n\nconst SmartyStreetsSDK = require(\"smartystreets-javascript-sdk\");\nconst SmartyStreetsCore = SmartyStreetsSDK.core;\nconst Lookup = SmartyStreetsSDK.usStreet.Lookup;\n\nlet authId = 24176270692624972; // created on smartystreets account page for localhost\nlet authToken = process.env.SMARTY_AUTH_TOKEN;\nconst credentials = new SmartyStreetsCore.StaticCredentials(authId, authToken);\n\nlet verifyAddress = SmartyStreetsCore.buildClient.usStreet(credentials);\n\nlet batch = new SmartyStreetsCore.Batch();\nlet lookup1 = new Lookup();\n\nfunction HandleDisplayErrors(props) {\n    let buffer = [];\n    if (props.display_errors) {\n        if (!props.address_verified) {\n            buffer.push(\n                <div key=\"address1\" style={{ color: \"red\" }}>\n                    * Please enter a valid Shipping Address.\n                </div>\n            );\n        }\n    }\n    return <div style={{ padding: 10 }}>{buffer}</div>;\n}\n\nexport default class Checkout extends Component {\n    constructor(props) {\n        super(props);\n        // Assign state itself, and a default value for items\n        this.state = {\n            address_line1: \"\",\n            address_line2: \"\",\n            address_secondary: \"\",\n            address_zipcode: \"\",\n            address_city: \"\",\n            address_state: \"\",\n\n            email_address: \"\",\n            isAddressChanged: false,\n            id: \"\",\n            first_name: \"\",\n            last_name: \"\",\n        };\n\n        this.address_verified = true;\n        this.display_errors = false;\n        this.cart = [];\n    }\n\n    async componentDidMount() {\n        await this.sessionCheck();\n        await this.loadUserValues();\n        this.forceUpdate();\n    }\n\n    verifyShippingAddress() {\n        return new Promise((resolve) => {\n            lookup1.street = this.state.address_line1;\n            lookup1.street2 = this.state.address_line2;\n            lookup1.secondary = this.state.address_secondary;\n            lookup1.city = this.state.address_city;\n            lookup1.state = this.state.address_state;\n            lookup1.zipCode = this.state.address_zipcode;\n            lookup1.match = \"invalid\"; // \"invalid\" is the most permissive match\n            batch.add(lookup1);\n            verifyAddress\n                .send(batch)\n                .then((response) => {\n                    this.address_verified = true;\n                    resolve(\"resolved\");\n                })\n                .catch(() => {\n                    this.address_verified = false;\n                    console.log(\"address NOT verified\");\n                });\n        });\n    }\n\n    loadUserValues() {\n        return new Promise((resolve) => {\n            axios\n                .get(\n                    \"http://localhost:4000/catweallgetalong/sessions/user-info\"\n                )\n                .then((response) => {\n                    this.setState({\n                        address_line1:\n                            response.data[0].shipping_address[0].street1,\n                        address_line2:\n                            response.data[0].shipping_address[0].street2,\n                        address_secondary:\n                            response.data[0].shipping_address[0].secondary,\n                        address_zipcode:\n                            response.data[0].shipping_address[0].zipcode,\n                        address_city: response.data[0].shipping_address[0].city,\n                        address_state:\n                            response.data[0].shipping_address[0].state,\n                        email_address: response.data[0].email_address,\n                        first_name: response.data[0].first_name,\n                        last_name: response.data[0].last_name,\n                        id: response.data[0]._id,\n                    });\n                })\n                .catch(function (error) {\n                    console.log(error);\n                });\n        });\n    }\n\n    sessionCheck() {\n        return new Promise((resolve) => {\n            axios\n                .get(\"http://localhost:4000/catweallgetalong/sessions/\")\n                .then((res) => {\n                    //do something\n                    if (res.data === true) {\n                        this.directTo = \"/checkout\";\n                    } else {\n                        this.directTo = \"/account\";\n                    }\n\n                    resolve(\"resolved\");\n                })\n                .catch(function (error) {\n                    console.log(error);\n                });\n        });\n    }\n\n    async handleOnSubmit(event) {\n        event.preventDefault();\n\n        // check address is valid\n        if (\n            this.state.address_line1.length > 0 &&\n            this.state.address_city.length > 0 &&\n            this.state.address_state.length > 0 &&\n            this.state.address_zipcode.length > 0 &&\n            this.state.isAddressChanged\n        ) {\n            await this.verifyShippingAddress();\n        }\n\n        if (this.address_verified && !this.state.isAddressChanged) {\n            // create order in db, and retrive the ID\n            // clear cart\n            // show order confirmed with order id\n            // add order id to account order_history\n            console.log(this.cart);\n        } else {\n            // inject red text informing what to fix\n            this.display_errors = true;\n            this.forceUpdate();\n        }\n    }\n\n    render() {\n        return (\n            <ProductConsumer>\n                {(value) => {\n                    const { cart } = value;\n                    if (cart.length < 1) return <Redirect push to=\"/cart\" />;\n                    else {\n                        this.cart = cart;\n                        // return (\n                        //     <div style={{ margin: 50 }}>\n                        //         <Title\n                        //             name=\"Confirm\"\n                        //             title=\"Shipping Address\"\n                        //         />\n                        //         <ProductConsumer>\n                        //             {(value) => {\n                        //                 const { cart } = value;\n                        //                 if (cart.length < 1)\n                        //                     return <Redirect push to=\"/cart\" />;\n                        //                 else {\n                        //                     this.cart = cart;\n                        //                 }\n                        //             }}\n                        //         </ProductConsumer>\n                        //         <HandleDisplayErrors\n                        //             display_errors={this.display_errors}\n                        //             address_verified={this.address_verified}\n                        //         />\n                        //         <form>\n                        //             <div className=\"form-group\">\n                        //                 <label htmlFor=\"addLine1\">\n                        //                     Address Line 1\n                        //                 </label>\n                        //                 <input\n                        //                     type=\"address\"\n                        //                     className=\"form-control\"\n                        //                     id=\"addLine1\"\n                        //                     placeholder=\"3901 SW 154th Ave\"\n                        //                     onChange={(event) =>\n                        //                         this.setState({\n                        //                             address_line1:\n                        //                                 event.target.value,\n                        //                             isAddressChanged: true,\n                        //                         })\n                        //                     }\n                        //                     value={this.state.address_line1}\n                        //                 />\n                        //             </div>\n                        //             <div className=\"form-group\">\n                        //                 <label htmlFor=\"addLine2\">\n                        //                     Address Line 2\n                        //                 </label>\n                        //                 <input\n                        //                     type=\"address\"\n                        //                     className=\"form-control\"\n                        //                     id=\"addLine2\"\n                        //                     placeholder=\"closest under the street\"\n                        //                     onChange={(event) =>\n                        //                         this.setState({\n                        //                             address_line2:\n                        //                                 event.target.value,\n                        //                             isAddressChanged: true,\n                        //                         })\n                        //                     }\n                        //                     value={this.state.address_line2}\n                        //                 />\n                        //             </div>\n                        //             <div className=\"form-group\">\n                        //                 <label htmlFor=\"secondary\">\n                        //                     Apt / Suite / Other\n                        //                 </label>\n                        //                 <input\n                        //                     type=\"address\"\n                        //                     className=\"form-control\"\n                        //                     id=\"secondary\"\n                        //                     placeholder=\"Apt# 314\"\n                        //                     onChange={(event) =>\n                        //                         this.setState({\n                        //                             address_secondary:\n                        //                                 event.target.value,\n                        //                             isAddressChanged: true,\n                        //                         })\n                        //                     }\n                        //                     value={this.state.address_secondary}\n                        //                 />\n                        //             </div>\n                        //             <div className=\"form-group\">\n                        //                 <label htmlFor=\"city\">City</label>\n                        //                 <input\n                        //                     type=\"address\"\n                        //                     className=\"form-control\"\n                        //                     id=\"city\"\n                        //                     placeholder=\"Davie\"\n                        //                     onChange={(event) =>\n                        //                         this.setState({\n                        //                             address_city:\n                        //                                 event.target.value,\n                        //                             isAddressChanged: true,\n                        //                         })\n                        //                     }\n                        //                     value={this.state.address_city}\n                        //                 />\n                        //             </div>\n                        //             <div className=\"form-group\">\n                        //                 <label htmlFor=\"zip\">Zipcode</label>\n                        //                 <input\n                        //                     type=\"address\"\n                        //                     className=\"form-control\"\n                        //                     id=\"zip\"\n                        //                     placeholder=\"33331\"\n                        //                     onChange={(event) =>\n                        //                         this.setState({\n                        //                             address_zipcode:\n                        //                                 event.target.value,\n                        //                             isAddressChanged: true,\n                        //                         })\n                        //                     }\n                        //                     value={this.state.address_zipcode}\n                        //                 />\n                        //             </div>\n                        //             <div className=\"form-group\">\n                        //                 <label\n                        //                     htmlFor=\"state\"\n                        //                     className=\"col-s control-label\"\n                        //                 >\n                        //                     State\n                        //                 </label>\n                        //                 <div className=\"col-s\">\n                        //                     <select\n                        //                         className=\"form-control\"\n                        //                         id=\"state\"\n                        //                         name=\"state\"\n                        //                         onChange={(event) =>\n                        //                             this.setState({\n                        //                                 address_state:\n                        //                                     event.target.value,\n                        //                                 isAddressChanged: true,\n                        //                             })\n                        //                         }\n                        //                         value={this.state.address_state}\n                        //                     >\n                        //                         <option value=\"\">N/A</option>\n                        //                         <option value=\"AK\">\n                        //                             Alaska\n                        //                         </option>\n                        //                         <option value=\"AL\">\n                        //                             Alabama\n                        //                         </option>\n                        //                         <option value=\"AR\">\n                        //                             Arkansas\n                        //                         </option>\n                        //                         <option value=\"AZ\">\n                        //                             Arizona\n                        //                         </option>\n                        //                         <option value=\"CA\">\n                        //                             California\n                        //                         </option>\n                        //                         <option value=\"CO\">\n                        //                             Colorado\n                        //                         </option>\n                        //                         <option value=\"CT\">\n                        //                             Connecticut\n                        //                         </option>\n                        //                         <option value=\"DC\">\n                        //                             District of Columbia\n                        //                         </option>\n                        //                         <option value=\"DE\">\n                        //                             Delaware\n                        //                         </option>\n                        //                         <option value=\"FL\">\n                        //                             Florida\n                        //                         </option>\n                        //                         <option value=\"GA\">\n                        //                             Georgia\n                        //                         </option>\n                        //                         <option value=\"HI\">\n                        //                             Hawaii\n                        //                         </option>\n                        //                         <option value=\"IA\">Iowa</option>\n                        //                         <option value=\"ID\">\n                        //                             Idaho\n                        //                         </option>\n                        //                         <option value=\"IL\">\n                        //                             Illinois\n                        //                         </option>\n                        //                         <option value=\"IN\">\n                        //                             Indiana\n                        //                         </option>\n                        //                         <option value=\"KS\">\n                        //                             Kansas\n                        //                         </option>\n                        //                         <option value=\"KY\">\n                        //                             Kentucky\n                        //                         </option>\n                        //                         <option value=\"LA\">\n                        //                             Louisiana\n                        //                         </option>\n                        //                         <option value=\"MA\">\n                        //                             Massachusetts\n                        //                         </option>\n                        //                         <option value=\"MD\">\n                        //                             Maryland\n                        //                         </option>\n                        //                         <option value=\"ME\">\n                        //                             Maine\n                        //                         </option>\n                        //                         <option value=\"MI\">\n                        //                             Michigan\n                        //                         </option>\n                        //                         <option value=\"MN\">\n                        //                             Minnesota\n                        //                         </option>\n                        //                         <option value=\"MO\">\n                        //                             Missouri\n                        //                         </option>\n                        //                         <option value=\"MS\">\n                        //                             Mississippi\n                        //                         </option>\n                        //                         <option value=\"MT\">\n                        //                             Montana\n                        //                         </option>\n                        //                         <option value=\"NC\">\n                        //                             North Carolina\n                        //                         </option>\n                        //                         <option value=\"ND\">\n                        //                             North Dakota\n                        //                         </option>\n                        //                         <option value=\"NE\">\n                        //                             Nebraska\n                        //                         </option>\n                        //                         <option value=\"NH\">\n                        //                             New Hampshire\n                        //                         </option>\n                        //                         <option value=\"NJ\">\n                        //                             New Jersey\n                        //                         </option>\n                        //                         <option value=\"NM\">\n                        //                             New Mexico\n                        //                         </option>\n                        //                         <option value=\"NV\">\n                        //                             Nevada\n                        //                         </option>\n                        //                         <option value=\"NY\">\n                        //                             New York\n                        //                         </option>\n                        //                         <option value=\"OH\">Ohio</option>\n                        //                         <option value=\"OK\">\n                        //                             Oklahoma\n                        //                         </option>\n                        //                         <option value=\"OR\">\n                        //                             Oregon\n                        //                         </option>\n                        //                         <option value=\"PA\">\n                        //                             Pennsylvania\n                        //                         </option>\n                        //                         <option value=\"PR\">\n                        //                             Puerto Rico\n                        //                         </option>\n                        //                         <option value=\"RI\">\n                        //                             Rhode Island\n                        //                         </option>\n                        //                         <option value=\"SC\">\n                        //                             South Carolina\n                        //                         </option>\n                        //                         <option value=\"SD\">\n                        //                             South Dakota\n                        //                         </option>\n                        //                         <option value=\"TN\">\n                        //                             Tennessee\n                        //                         </option>\n                        //                         <option value=\"TX\">\n                        //                             Texas\n                        //                         </option>\n                        //                         <option value=\"UT\">Utah</option>\n                        //                         <option value=\"VA\">\n                        //                             Virginia\n                        //                         </option>\n                        //                         <option value=\"VT\">\n                        //                             Vermont\n                        //                         </option>\n                        //                         <option value=\"WA\">\n                        //                             Washington\n                        //                         </option>\n                        //                         <option value=\"WI\">\n                        //                             Wisconsin\n                        //                         </option>\n                        //                         <option value=\"WV\">\n                        //                             West Virginia\n                        //                         </option>\n                        //                         <option value=\"WY\">\n                        //                             Wyoming\n                        //                         </option>\n                        //                     </select>\n                        //                 </div>\n                        //             </div>\n\n                        //             <button\n                        //                 className=\"btn btn-success text-uppercase mb-3 px-5\"\n                        //                 onClick={this.handleOnSubmit.bind(this)}\n                        //             >\n                        //                 Submit Order\n                        //             </button>\n                        //         </form>\n                        //     </div>\n                        // );\n                    }\n                }}\n            </ProductConsumer>\n        );\n    }\n}\n"]},"metadata":{},"sourceType":"module"}